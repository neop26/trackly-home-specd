# [CHECKLIST TYPE] Checklist: [FEATURE NAME]

**Purpose**: [Brief description of what this checklist covers]
**Created**: [DATE]
**Feature**: [Link to spec.md or relevant documentation]

**Note**: This checklist is generated by the `/speckit.checklist` command based on feature context and requirements.

---

## Pre-Implementation Checklist

Use this before starting implementation:

- [ ] CHK001 Spec.md reviewed and requirements understood
- [ ] CHK002 Plan.md reviewed and technical approach clear
- [ ] CHK003 Constitution principles considered
- [ ] CHK004 Local development environment ready
- [ ] CHK005 On correct feature branch

## Security Checklist (Trackly Home)

Use for any feature touching data or auth:

### Database Security
- [ ] SEC001 New tables have RLS enabled
- [ ] SEC002 SELECT policies enforce household membership
- [ ] SEC003 INSERT policies verify target household
- [ ] SEC004 UPDATE policies restrict appropriately (admin-only if needed)
- [ ] SEC005 No recursive helper functions

### Edge Function Security
- [ ] SEC006 verify_jwt = true in function config
- [ ] SEC007 User authentication checked
- [ ] SEC008 Admin role verified for privileged ops
- [ ] SEC009 Service role key never in response
- [ ] SEC010 No PII in logs or errors

### Frontend Security
- [ ] SEC011 No secrets in client code
- [ ] SEC012 Auth state checked before API calls
- [ ] SEC013 Error messages don't leak internals

### Data Isolation
- [ ] SEC014 Cross-household access tested and blocked
- [ ] SEC015 Tokens hashed before storage
- [ ] SEC016 Token expiry enforced

## Pre-Merge Checklist

Use before creating PR:

- [ ] MRG001 `npm run build` passes
- [ ] MRG002 `npm run lint` passes
- [ ] MRG003 Manual smoke test complete
- [ ] MRG004 Security checklist passed (if applicable)
- [ ] MRG005 Documentation updated
- [ ] MRG006 Commit messages follow conventional format
- [ ] MRG007 tasks.md updated with completion status

## Pre-Deploy Checklist

Use before deploying to dev/prod:

### Build Verification
- [ ] DEP001 Build produces dist/ folder
- [ ] DEP002 No TypeScript errors
- [ ] DEP003 staticwebapp.config.json in dist/

### Local Testing
- [ ] DEP004 Magic link sign-in works
- [ ] DEP005 Household creation works
- [ ] DEP006 Invite flow works (admin)
- [ ] DEP007 Role management works (admin)
- [ ] DEP008 Non-admin restrictions work

### Database
- [ ] DEP009 Migrations apply cleanly
- [ ] DEP010 RLS policies verified

### Edge Functions
- [ ] DEP011 Functions tested locally
- [ ] DEP012 CORS headers correct

### Documentation
- [ ] DEP013 PROJECT_TRACKER.md updated
- [ ] DEP014 Migration README updated (if DB changes)

## RLS Audit Checklist

Use for comprehensive RLS review:

### profiles Table
- [ ] RLS001 RLS enabled
- [ ] RLS002 SELECT: Own profile only
- [ ] RLS003 INSERT: Own profile only
- [ ] RLS004 UPDATE: Own profile only

### households Table
- [ ] RLS005 RLS enabled
- [ ] RLS006 SELECT: Members only
- [ ] RLS007 INSERT: Via edge function
- [ ] RLS008 UPDATE: Owner only

### household_members Table
- [ ] RLS009 RLS enabled
- [ ] RLS010 SELECT: Household members
- [ ] RLS011 INSERT: Via edge function
- [ ] RLS012 UPDATE: Admins only
- [ ] RLS013 Last admin protection trigger works

### invites Table
- [ ] RLS014 RLS enabled
- [ ] RLS015 SELECT: Household members
- [ ] RLS016 INSERT: Admins only
- [ ] RLS017 Tokens stored as hashes

## Notes

- Check items off as completed: `[x]`
- Add comments or findings inline
- Link to relevant resources or documentation
- Items are numbered for easy reference (CHK=general, SEC=security, MRG=merge, DEP=deploy, RLS=policies)

